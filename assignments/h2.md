# h2 - soitto kotiin

**Tekniset tiedot:**
- Tietokone: HP EliteDesk 800 G3 DM 35W
- Käyttöjärjestelmä: Ubuntu 24.04.2 LTS
- Prosessori: Intel® Core™ i5-7500T × 4
- Muisti: 256.1 GB
- Ram: 8 GB

Tehtävänanto: [https://terokarvinen.com/palvelinten-hallinta/#h2-soitto-kotiin](https://terokarvinen.com/palvelinten-hallinta/#h2-soitto-kotiin)

## x) Tiivistelmät
### Two machine virtual network with debian 11 bullseye and vagrant
- Vagrant mahdollistaa usean virtuaalikoneen hallinan sekä konfiguroinnin, ilman graafista käyttöliittymää
- Käydään läpi Vagrantin ja Virtualboxin asennus
- Configuroidaan kaksi virtuaalikonetta
- Käydään läpi niiden käynnistys sekä tuhoaminen
  
Lähde: ([Karvinen 2021](https://terokarvinen.com/2021/two-machine-virtual-network-with-debian-11-bullseye-and-vagrant/))

### Salt Quickstart – Salt Stack Master and Slave on Ubuntu Linux
- Saltilla voimme hallinnoida tuhansia palvelimia
- Salt-master sekä salt-minionin asennus
- Salt-masterilla tulee olla julkinen ip-osoite
- Orjaan yhdistäminen sekä komentojen ajaminen

Lähde: ([Karvinen 2018](https://terokarvinen.com/2018/salt-quickstart-salt-stack-master-and-slave-on-ubuntu-linux/))

### Salt Vagrant - automatically provision one master and two slaves
- 

Lähde: ([Karvinen 2023](https://terokarvinen.com/2023/salt-vagrant/#infra-as-code---your-wishes-as-a-text-file))

## a) Hello Vagrant!

**Asennetaan Vagrant**

Asennusohjeet: https://developer.hashicorp.com/vagrant/install - "Linux - Ubuntu/Debian"

Ajetaan yksi komento kerralla:

<pre>
$ sudo wget -O - https://apt.releases.hashicorp.com/gpg | sudo gpg --dearmor -o /usr/share/keyrings/hashicorp-archive-keyring.gpg
$ sudo echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com $(lsb_release -cs) main" | $ sudo tee /etc/apt/sources.list.d/hashicorp.list
$ sudo apt update && sudo apt install vagrant
</pre>

Tarkastetaan asennus ja versio:
<pre>
$ vagrant --version
</pre>

**Tulos:** Vagrant 2.3.4

**Asennetaan Virtualbox**

<pre>
$ sudo apt install virtualbox
</pre>

Tarkastetaan onnistunut asennus:

<pre>
$ virtualbox --version
</pre>

**Tulos:** Virtualbox ohjelma aukeaa.

Lähde: ([HashiCorp](https://developer.hashicorp.com/vagrant/install) | [Orcale](https://www.virtualbox.org/wiki/Linux_Downloads))
 
## b) Linux Vagrant. Tee Vagrantilla uusi Linux-virtuaalikone

Aloitamme tekemällä kotihakemistoon uuden hakemiston nimeltään "twohost"

<pre>
$ cd
$ mkdir twohost
</pre>

Tehdään vagrant konfigurointi juuri luotuun hakemistoon.

<pre>
$ cd twohost
$ sudo vagrant init
</pre>

Tämä luo hakemistoon tiedoston nimeltään "Vagrantfile". Voimme konfiguroida uusia virtuaalikoneita muokkaamalla tätä tiedostoa.

**Tulos:**
<pre>
$ ls -l
  
drwxrwxr-x 2 henrik henrik 4096 Apr  7 19:23 shared
-rw-rw-r-- 1 henrik henrik  639 Apr  7 19:30 Vagrantfile
</pre>

Muokataan tiedostoa ja lisätään uusi virtuaalikone.
<pre>
$ sudo nano Vagrantfile
</pre>

Lisätään seuraava teksti ja tallennetaan:

![config-t001](/assignments/img/h2-img/config-t001.png)

Nyt voimme käynnistää ensimmäisen virtuaalikoneen ajamalla komennon:

<pre>
$ sudo vagrant up
</pre>

Tarkastamme että virtuaalikone on käynnissä:

<pre>
$ sudo vagrant status
</pre>

Katso kohta "Current machine states" : t001 running (virtualbox)

![status-t001](/assignments/img/h2-img/t001-status.png)

Lähde: ([Karvinen 2021](https://terokarvinen.com/2021/two-machine-virtual-network-with-debian-11-bullseye-and-vagrant/))

## c) Kaksin kaunihimpi. Tee kahden Linux-tietokoneen verkko Vagrantilla. Osoita, että koneet voivat pingata toisiaan.

Jatkamme saman tiedoston (Vagrantfilen) käyttöä. 

Lisätään konfigurointiin toinen virtuaalikone.

<pre>
$ sudo nano Vagrantfile
</pre>

Lisätään alla oleva teksti scriptin loppuun, edellisen "t001" konfiguroinnin alle.

	config.vm.define "t002", primary: true do |t002|
		t002.vm.hostname = "t002"
		t002.vm.network "private_network", ip: "192.168.56.20"
	end

**Tulos**
 
![two-host-vagrantfile](/assignments/img/h2-img/two-host-vagrantfile.png)


## d) Demonstroi Salt herra-orja arkkitehtuurin toimintaa.

## e) Kokeile vähintään kahta tilaa verkon yli (viisikosta: pkg, file, service, user, cmd)


## Lähteet

1. Karvinen 2021. Two machine virtual network with debian 11 bullseye and vagrant. Luettavissa: https://terokarvinen.com/2023/salt-vagrant/#infra-as-code---your-wishes-as-a-text-file/. Luettu: 6.4.2025.
2. Karvinen 2018. Salt Quickstart - Salt Stack Master and Slave on Ubuntu Linux. Luettavissa: https://terokarvinen.com/2018/salt-quickstart-salt-stack-master-and-slave-on-ubuntu-linux/. Luettu: 6.4.2025.
3. Karvinen 2023. Salt Vagrant - automatically provision one master and two slaves. Luettavissa: https://terokarvinen.com/2023/salt-vagrant/#infra-as-code---your-wishes-as-a-text-file. Luettu: 6.4.2025.
4. HashiCorp. Install Vagrant. Luettavissa: https://developer.hashicorp.com/vagrant/install. Luettu: 7.4.2025.
5. Oracle. VirtualBox. Luettavissa: https://www.virtualbox.org/wiki/Linux_Downloads. Luettu: 7.4.2025





